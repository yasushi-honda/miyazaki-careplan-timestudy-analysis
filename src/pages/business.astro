---
import Layout from '../layouts/Layout.astro';
import AnalysisChart from '../components/AnalysisChart.astro';
import { getCsvData } from '../data/csvDataJson.js';

// CSVãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿
console.log('CSVãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã‚’é–‹å§‹ã—ã¾ã™...');
const beforeData = getCsvData('business_before.csv');
const afterData = getCsvData('business_after.csv');

console.log('beforeData ä»¶æ•°:', beforeData.length);
console.log('afterData ä»¶æ•°:', afterData.length);

// å…±æœ‰æ–¹æ³•ã”ã¨ã®å¹³å‡æ™‚é–“ã‚’è¨ˆç®—
const calculateAverageTimesByMethod = (data) => {
  const methods = ["FAX", "ãƒ¡ãƒ¼ãƒ«", "æŒå‚", "éƒµé€", "ã‚·ã‚¹ãƒ†ãƒ ", "ãã®ä»–"];
  const result = {};
  
  methods.forEach(method => {
    const filteredData = data.filter(row => {
      const sharingMethod = row["ã‚±ã‚¢ãƒ—ãƒ©ãƒ³å…±æœ‰æ–¹æ³•"] || row["å…±æœ‰æ–¹æ³•"];
      return sharingMethod === method;
    });
    
    if (filteredData.length === 0) {
      result[method] = 0;
      return;
    }
    
    const totalCreationTime = filteredData.reduce((sum, row) => {
      return sum + parseInt(row["1ãƒ¶æœˆã‚ãŸã‚Šã®æä¾›ç¥¨ä½œæˆæ™‚é–“ï¼ˆåˆ†ï¼‰"] || 0);
    }, 0);
    
    const totalConfirmationTime = filteredData.reduce((sum, row) => {
      return sum + parseInt(row["1ãƒ¶æœˆã‚ãŸã‚Šã®å®Ÿç¸¾ç¢ºèªæ™‚é–“ï¼ˆåˆ†ï¼‰"] || 0);
    }, 0);
    
    // åˆè¨ˆæ™‚é–“ï¼ˆåˆ†ï¼‰ã‚’è¨ˆç®—
    const totalTimeMinutes = totalCreationTime + totalConfirmationTime;
    
    // å¹³å‡æ™‚é–“ã‚’è¨ˆç®—ï¼ˆæ™‚é–“å˜ä½ã«å¤‰æ›ï¼‰
    result[method] = Math.round((totalTimeMinutes / filteredData.length) / 60 * 10) / 10;
  });
  
  return result;
};

const beforeTimes = calculateAverageTimesByMethod(beforeData);
const afterTimes = calculateAverageTimesByMethod(afterData);

// å…¨ä½“ã®å¹³å‡æ™‚é–“ã‚’è¨ˆç®—
const calculateOverallAverages = (data) => {
  if (data.length === 0) return { creation: 0, confirmation: 0, modification: 0 };
  
  const totalCreation = data.reduce((sum, row) => sum + parseInt(row["1ãƒ¶æœˆã‚ãŸã‚Šã®æä¾›ç¥¨ä½œæˆæ™‚é–“ï¼ˆåˆ†ï¼‰"] || 0), 0);
  const totalConfirmation = data.reduce((sum, row) => sum + parseInt(row["1ãƒ¶æœˆã‚ãŸã‚Šã®å®Ÿç¸¾ç¢ºèªæ™‚é–“ï¼ˆåˆ†ï¼‰"] || 0), 0);
  const totalModification = data.reduce((sum, row) => sum + parseInt(row["åˆ©ç”¨è€…ã‹ã‚‰ã®ã‚±ã‚¢ãƒ—ãƒ©ãƒ³ä¿®æ­£ä¾é ¼ã‚’å—ã‘ã¦ã‹ã‚‰ä¿®æ­£å®Œäº†ã¾ã§ã«è¦ã™ã‚‹æ™‚é–“ï¼ˆåˆ†ï¼‰"] || 0), 0);
  
  return {
    creation: Math.round(totalCreation / data.length),
    confirmation: Math.round(totalConfirmation / data.length),
    modification: Math.round(totalModification / data.length)
  };
};

const beforeAverages = calculateOverallAverages(beforeData);
const afterAverages = calculateOverallAverages(afterData);

// æ™‚é–“å‰Šæ¸›åŠ¹æœã‚’è¨ˆç®—
const timeReduction = {
  creation: beforeAverages.creation - afterAverages.creation,
  confirmation: beforeAverages.confirmation - afterAverages.confirmation,
  modification: beforeAverages.modification - afterAverages.modification,
  total: (beforeAverages.creation + beforeAverages.confirmation) - (afterAverages.creation + afterAverages.confirmation)
};

// å‰Šæ¸›ç‡ã‚’è¨ˆç®—
const reductionPercentage = {
  creation: Math.round((timeReduction.creation / beforeAverages.creation) * 100),
  confirmation: Math.round((timeReduction.confirmation / beforeAverages.confirmation) * 100),
  modification: Math.round((timeReduction.modification / beforeAverages.modification) * 100),
  total: Math.round((timeReduction.total / (beforeAverages.creation + beforeAverages.confirmation)) * 100)
};

// äº‹æ¥­æ‰€ã®å¹³å‡è·å“¡æ•°ï¼ˆä»®å®šï¼‰
const averageStaffCount = 15;

// å¹´é–“å‰Šæ¸›æ™‚é–“ã‚’è¨ˆç®—ï¼ˆæœˆé–“å‰Šæ¸›æ™‚é–“ Ã— 12ãƒ¶æœˆ Ã— å¹³å‡è·å“¡æ•°ï¼‰
const annualTimeSaved = timeReduction.total * 12 * averageStaffCount;

// å¹´é–“å‰Šæ¸›æ™‚é–“ã‚’æ™‚é–“ã¨åˆ†ã«å¤‰æ›
const annualHours = Math.floor(annualTimeSaved / 60);
const annualMinutes = annualTimeSaved % 60;

// å¹´é–“äººä»¶è²»å‰Šæ¸›é¡ã‚’è¨ˆç®—ï¼ˆæ™‚çµ¦2,000å††ã¨ä»®å®šï¼‰
const hourlyWage = 2000; // å††/æ™‚é–“
const annualCostSaving = Math.round((annualTimeSaved / 60) * hourlyWage);
const formattedCostSaving = new Intl.NumberFormat('ja-JP').format(annualCostSaving);

// ã‚·ã‚¹ãƒ†ãƒ å°å…¥ç‡ã®è¨ˆç®—
const calculateSystemAdoptionRate = (data) => {
  if (data.length === 0) return 0;
  
  const systemUsers = data.filter(row => {
    const sharingMethod = row["ã‚±ã‚¢ãƒ—ãƒ©ãƒ³å…±æœ‰æ–¹æ³•"] || row["å…±æœ‰æ–¹æ³•"];
    return sharingMethod === "ã‚·ã‚¹ãƒ†ãƒ ";
  }).length;
  
  return Math.round((systemUsers / data.length) * 100);
};

const beforeAdoptionRate = calculateSystemAdoptionRate(beforeData);
const afterAdoptionRate = calculateSystemAdoptionRate(afterData);
const adoptionRateIncrease = afterAdoptionRate - beforeAdoptionRate;

---

<Layout title="äº‹æ¥­æ‰€åˆ†æ | å®®å´çœŒã‚±ã‚¢ãƒ—ãƒ©ãƒ³ãƒ‡ãƒ¼ã‚¿é€£æºã‚·ã‚¹ãƒ†ãƒ å°å…¥åŠ¹æœåˆ†æ">
  <main class="container">
    <section class="page-header">
      <div class="header-content">
        <h1>äº‹æ¥­æ‰€ãƒ¬ãƒ™ãƒ«ã§ã®å°å…¥åŠ¹æœåˆ†æ</h1>
        <p class="lead">
          ã‚±ã‚¢ãƒ—ãƒ©ãƒ³ãƒ‡ãƒ¼ã‚¿é€£æºã‚·ã‚¹ãƒ†ãƒ ã®å°å…¥ã«ã‚ˆã‚‹äº‹æ¥­æ‰€å…¨ä½“ã®æ¥­å‹™åŠ¹ç‡åŒ–ã¨çµŒæ¸ˆåŠ¹æœã‚’åˆ†æã—ã€çµ„ç¹”ã¨ã—ã¦ã®å°å…¥ãƒ¡ãƒªãƒƒãƒˆã‚’å¯è¦–åŒ–ã—ã¦ã„ã¾ã™ã€‚
        </p>
        <div class="header-decoration">
          <div class="decoration-circle"></div>
          <div class="decoration-line"></div>
        </div>
      </div>
    </section>

    <section class="key-findings card">
      <h2><span class="icon">ğŸ“Š</span>ä¸»è¦ãªåˆ†æçµæœ</h2>
      
      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-icon">â±ï¸</div>
          <div class="stat-value">{annualHours}æ™‚é–“{annualMinutes}åˆ†</div>
          <div class="stat-label">å¹´é–“ç·å‰Šæ¸›æ™‚é–“</div>
          <div class="stat-description">äº‹æ¥­æ‰€å…¨ä½“ã§ã®å¹´é–“å‰Šæ¸›æ™‚é–“</div>
        </div>
        
        <div class="stat-card">
          <div class="stat-icon">ğŸ’¹</div>
          <div class="stat-value">{formattedCostSaving}å††</div>
          <div class="stat-label">å¹´é–“äººä»¶è²»å‰Šæ¸›</div>
          <div class="stat-description">æ™‚çµ¦2,000å††æ›ç®—</div>
        </div>
        
        <div class="stat-card">
          <div class="stat-icon">ğŸ“ˆ</div>
          <div class="stat-value">{adoptionRateIncrease}%</div>
          <div class="stat-label">ã‚·ã‚¹ãƒ†ãƒ å°å…¥ç‡å‘ä¸Š</div>
          <div class="stat-description">å°å…¥å‰å¾Œã§ã®åˆ©ç”¨ç‡å¢—åŠ </div>
        </div>
      </div>
    </section>

    <section class="time-comparison card">
      <h2><span class="icon">â³</span>æ¥­å‹™åˆ¥æ™‚é–“æ¯”è¼ƒ</h2>
      
      <div class="comparison-table">
        <table>
          <thead>
            <tr>
              <th>æ¥­å‹™å†…å®¹</th>
              <th>å°å…¥å‰</th>
              <th>å°å…¥å¾Œ</th>
              <th>å‰Šæ¸›æ™‚é–“</th>
              <th>å‰Šæ¸›ç‡</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><span class="task-icon">ğŸ“</span> æä¾›ç¥¨ä½œæˆ</td>
              <td>{beforeAverages.creation}åˆ†</td>
              <td>{afterAverages.creation}åˆ†</td>
              <td>{timeReduction.creation}åˆ†</td>
              <td><span class="badge badge-success">{reductionPercentage.creation}%</span></td>
            </tr>
            <tr>
              <td><span class="task-icon">ğŸ”</span> å®Ÿç¸¾ç¢ºèª</td>
              <td>{beforeAverages.confirmation}åˆ†</td>
              <td>{afterAverages.confirmation}åˆ†</td>
              <td>{timeReduction.confirmation}åˆ†</td>
              <td><span class="badge badge-success">{reductionPercentage.confirmation}%</span></td>
            </tr>
            <tr>
              <td><span class="task-icon">âœï¸</span> ä¿®æ­£å¯¾å¿œ</td>
              <td>{beforeAverages.modification}åˆ†</td>
              <td>{afterAverages.modification}åˆ†</td>
              <td>{timeReduction.modification}åˆ†</td>
              <td><span class="badge badge-success">{reductionPercentage.modification}%</span></td>
            </tr>
            <tr class="total-row">
              <td><span class="task-icon">ğŸ”„</span> åˆè¨ˆæ™‚é–“</td>
              <td>{beforeAverages.creation + beforeAverages.confirmation}åˆ†</td>
              <td>{afterAverages.creation + afterAverages.confirmation}åˆ†</td>
              <td>{timeReduction.total}åˆ†</td>
              <td><span class="badge badge-success">{reductionPercentage.total}%</span></td>
            </tr>
          </tbody>
        </table>
      </div>
      
      <div class="data-insights">
        <div class="insight-card">
          <div class="insight-icon">ğŸ’¡</div>
          <div class="insight-content">
            <h3>åˆ†æãƒã‚¤ãƒ³ãƒˆ</h3>
            <p>ã‚·ã‚¹ãƒ†ãƒ å°å…¥ã«ã‚ˆã‚Šã€æä¾›ç¥¨ä½œæˆã¨å®Ÿç¸¾ç¢ºèªã®ä¸¡æ–¹ã§å¤§å¹…ãªæ™‚é–“å‰Šæ¸›ãŒå®Ÿç¾ã—ã¦ã„ã¾ã™ã€‚ç‰¹ã«ä¿®æ­£å¯¾å¿œæ™‚é–“ã®çŸ­ç¸®ã¯ã€æƒ…å ±å…±æœ‰ã®è¿…é€ŸåŒ–ã«ã‚ˆã‚‹ã‚‚ã®ã§ã™ã€‚</p>
          </div>
        </div>
      </div>
    </section>

    <section class="chart-section card">
      <h2><span class="icon">ğŸ“Š</span>å…±æœ‰æ–¹æ³•åˆ¥ã®æ™‚é–“æ¯”è¼ƒ</h2>
      <div class="chart-container">
        <AnalysisChart 
          id="analysisChart"
          chartType="bar"
          beforeData={beforeTimes}
          afterData={afterTimes}
          beforeLabel="æ™‚é–“ï¼ˆå°å…¥å‰ï¼‰"
          afterLabel="æ™‚é–“ï¼ˆå°å…¥å¾Œï¼‰"
          yAxisLabel="æ™‚é–“ (æ™‚é–“)"
          xAxisLabel="å…±æœ‰æ–¹æ³•"
          chartTitle="ã‚±ã‚¢ãƒ—ãƒ©ãƒ³å…±æœ‰æ–¹æ³•åˆ¥ æ‰€è¦æ™‚é–“ã®æ¯”è¼ƒ"
        />
      </div>
      
      <div class="chart-insights">
        <h3>åˆ†æçµæœã®ãƒã‚¤ãƒ³ãƒˆ</h3>
        <ul>
          <li><strong>ã‚·ã‚¹ãƒ†ãƒ å°å…¥åŠ¹æœï¼š</strong> ã‚·ã‚¹ãƒ†ãƒ ã«ã‚ˆã‚‹å…±æœ‰æ–¹æ³•ãŒæœ€ã‚‚åŠ¹ç‡çš„ã§ã€äº‹æ¥­æ‰€å…¨ä½“ã§ã®æ¥­å‹™æ™‚é–“å‰Šæ¸›ã«å¤§ããè²¢çŒ®ã—ã¦ã„ã¾ã™ã€‚</li>
          <li><strong>ã‚³ã‚¹ãƒˆå‰Šæ¸›åŠ¹æœï¼š</strong> æ¥­å‹™æ™‚é–“ã®å‰Šæ¸›ã¯ç›´æ¥çš„ãªäººä»¶è²»å‰Šæ¸›ã«ã¤ãªãŒã‚Šã€å¹´é–“ç´„{formattedCostSaving}å††ã®çµŒæ¸ˆåŠ¹æœãŒè¦‹è¾¼ã¾ã‚Œã¾ã™ã€‚</li>
          <li><strong>ã‚·ã‚¹ãƒ†ãƒ å°å…¥ç‡ï¼š</strong> å°å…¥å‰{beforeAdoptionRate}%ã‹ã‚‰å°å…¥å¾Œ{afterAdoptionRate}%ã¸ã¨{adoptionRateIncrease}%å¢—åŠ ã—ã€çµ„ç¹”å…¨ä½“ã§ã®åŠ¹ç‡åŒ–ãŒé€²ã‚“ã§ã„ã¾ã™ã€‚</li>
        </ul>
      </div>
    </section>

    <section class="roi-analysis card">
      <h2><span class="icon">ğŸ’°</span>æŠ•è³‡å¯¾åŠ¹æœï¼ˆROIï¼‰åˆ†æ</h2>
      <div class="roi-content">
        <div class="roi-intro">
          <p>
            ã‚±ã‚¢ãƒ—ãƒ©ãƒ³ãƒ‡ãƒ¼ã‚¿é€£æºã‚·ã‚¹ãƒ†ãƒ ã®å°å…¥ã«ã‚ˆã‚‹æŠ•è³‡å¯¾åŠ¹æœã‚’åˆ†æã—ã¾ã—ãŸã€‚
          </p>
        </div>
        
        <div class="roi-grid">
          <div class="roi-item">
            <div class="roi-item-header">
              <div class="roi-icon">ğŸ”§</div>
              <h3>åˆæœŸæŠ•è³‡ã‚³ã‚¹ãƒˆ</h3>
            </div>
            <ul>
              <li>ã‚·ã‚¹ãƒ†ãƒ å°å…¥è²»ç”¨</li>
              <li>ç ”ä¿®ãƒ»æ•™è‚²è²»ç”¨</li>
              <li>ç§»è¡ŒæœŸé–“ã®æ¥­å‹™èª¿æ•´ã‚³ã‚¹ãƒˆ</li>
            </ul>
          </div>
          
          <div class="roi-item">
            <div class="roi-item-header">
              <div class="roi-icon">â±ï¸</div>
              <h3>ç¶™ç¶šçš„ã‚³ã‚¹ãƒˆ</h3>
            </div>
            <ul>
              <li>ã‚·ã‚¹ãƒ†ãƒ åˆ©ç”¨æ–™ï¼ˆæœˆé¡/å¹´é¡ï¼‰</li>
              <li>ä¿å®ˆãƒ»ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹è²»ç”¨</li>
              <li>å®šæœŸçš„ãªç ”ä¿®è²»ç”¨</li>
            </ul>
          </div>
          
          <div class="roi-item">
            <div class="roi-item-header">
              <div class="roi-icon">ğŸ’¹</div>
              <h3>çµŒæ¸ˆçš„ãƒ¡ãƒªãƒƒãƒˆ</h3>
            </div>
            <ul>
              <li>å¹´é–“äººä»¶è²»å‰Šæ¸›ï¼šç´„{formattedCostSaving}å††</li>
              <li>ç´™è³‡æºãƒ»å°åˆ·ã‚³ã‚¹ãƒˆå‰Šæ¸›</li>
              <li>ä¿ç®¡ã‚¹ãƒšãƒ¼ã‚¹å‰Šæ¸›</li>
            </ul>
          </div>
          
          <div class="roi-item">
            <div class="roi-item-header">
              <div class="roi-icon">âœ¨</div>
              <h3>éçµŒæ¸ˆçš„ãƒ¡ãƒªãƒƒãƒˆ</h3>
            </div>
            <ul>
              <li>æƒ…å ±å…±æœ‰ã®æ­£ç¢ºæ€§å‘ä¸Š</li>
              <li>åˆ©ç”¨è€…ã‚µãƒ¼ãƒ“ã‚¹ã®è³ªå‘ä¸Š</li>
              <li>ã‚¹ã‚¿ãƒƒãƒ•ã®æ¥­å‹™æº€è¶³åº¦å‘ä¸Š</li>
            </ul>
          </div>
        </div>
        
        <div class="roi-summary">
          <div class="roi-summary-item">
            <div class="roi-summary-icon">â³</div>
            <div class="roi-summary-content">
              <p>
                <strong>æŠ•è³‡å›åæœŸé–“ï¼š</strong> å°å…¥ã‚³ã‚¹ãƒˆã¨å¹´é–“å‰Šæ¸›é¡ã‚’è€ƒæ…®ã™ã‚‹ã¨ã€ç´„1ã€œ2å¹´ã§ã®æŠ•è³‡å›åãŒè¦‹è¾¼ã¾ã‚Œã¾ã™ã€‚
              </p>
            </div>
          </div>
          <div class="roi-summary-item">
            <div class="roi-summary-icon">ğŸ“ˆ</div>
            <div class="roi-summary-content">
              <p>
                <strong>5å¹´é–“ã®ç´¯ç©åŠ¹æœï¼š</strong> 5å¹´é–“ã§ã®ç´¯ç©çµŒæ¸ˆåŠ¹æœã¯ç´„{new Intl.NumberFormat('ja-JP').format(annualCostSaving * 5)}å††ã¨è©¦ç®—ã•ã‚Œã¾ã™ã€‚
              </p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="recommendations card">
      <h2><span class="icon">ğŸ’¡</span>äº‹æ¥­æ‰€å‘ã‘æ¨å¥¨äº‹é …</h2>
      <div class="recommendations-content">
        <ol class="recommendation-list">
          <li class="recommendation-item">
            <div class="recommendation-number">1</div>
            <div class="recommendation-content">
              <strong>æ®µéšçš„ãªå°å…¥è¨ˆç”»ã®ç­–å®šï¼š</strong> 
              ã‚·ã‚¹ãƒ†ãƒ å°å…¥ç‡ã‚’ã•ã‚‰ã«é«˜ã‚ã‚‹ãŸã‚ã€éƒ¨é–€ã”ã¨ã«æ®µéšçš„ãªå°å…¥è¨ˆç”»ã‚’ç­–å®šã—ã€æˆåŠŸäº‹ä¾‹ã‚’çµ„ç¹”å†…ã§å…±æœ‰ã™ã‚‹ã“ã¨ãŒåŠ¹æœçš„ã§ã™ã€‚
            </div>
          </li>
          <li class="recommendation-item">
            <div class="recommendation-number">2</div>
            <div class="recommendation-content">
              <strong>å®šæœŸçš„ãªåŠ¹æœæ¸¬å®šï¼š</strong> 
              å››åŠæœŸã”ã¨ã«æ¥­å‹™æ™‚é–“ã®æ¸¬å®šã‚’è¡Œã„ã€ã‚·ã‚¹ãƒ†ãƒ å°å…¥åŠ¹æœã‚’ç¶™ç¶šçš„ã«æ¤œè¨¼ãƒ»æ”¹å–„ã™ã‚‹ã“ã¨ã§ã€ã•ã‚‰ãªã‚‹åŠ¹ç‡åŒ–ãŒæœŸå¾…ã§ãã¾ã™ã€‚
            </div>
          </li>
          <li class="recommendation-item">
            <div class="recommendation-number">3</div>
            <div class="recommendation-content">
              <strong>æ¥­å‹™ãƒ—ãƒ­ã‚»ã‚¹ã®æœ€é©åŒ–ï¼š</strong> 
              ã‚·ã‚¹ãƒ†ãƒ å°å…¥ã«åˆã‚ã›ã¦æ¥­å‹™ãƒ—ãƒ­ã‚»ã‚¹å…¨ä½“ã‚’è¦‹ç›´ã—ã€é‡è¤‡ä½œæ¥­ã®å‰Šæ¸›ã‚„æƒ…å ±å…±æœ‰ã®åŠ¹ç‡åŒ–ã‚’å›³ã‚‹ã“ã¨ãŒé‡è¦ã§ã™ã€‚
            </div>
          </li>
          <li class="recommendation-item">
            <div class="recommendation-number">4</div>
            <div class="recommendation-content">
              <strong>ä»–ã‚·ã‚¹ãƒ†ãƒ ã¨ã®é€£æºå¼·åŒ–ï¼š</strong> 
              æ—¢å­˜ã®æ¥­å‹™ã‚·ã‚¹ãƒ†ãƒ ã¨ã®é€£æºã‚’å¼·åŒ–ã™ã‚‹ã“ã¨ã§ã€ãƒ‡ãƒ¼ã‚¿å…¥åŠ›ã®é‡è¤‡ã‚’é¿ã‘ã€ã•ã‚‰ãªã‚‹æ¥­å‹™åŠ¹ç‡åŒ–ã‚’å®Ÿç¾ã§ãã¾ã™ã€‚
            </div>
          </li>
        </ol>
      </div>
    </section>

    <section class="navigation-links">
      <div class="nav-buttons">
        <a href="/" class="btn btn-primary">ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ã«æˆ»ã‚‹</a>
        <a href="/individual/" class="btn btn-secondary">å€‹äººåˆ†æã‚’è¦‹ã‚‹</a>
      </div>
    </section>
  </main>
</Layout>

<style>
  .page-header {
    text-align: center;
    margin-bottom: 2rem;
    position: relative;
    padding: 2rem 0;
  }

  .header-content {
    position: relative;
    z-index: 2;
  }

  .header-decoration {
    position: absolute;
    top: 0;
    right: 0;
    z-index: 1;
    opacity: 0.1;
  }

  .decoration-circle {
    width: 150px;
    height: 150px;
    border-radius: 50%;
    background-color: var(--accent);
    position: absolute;
    top: -50px;
    right: -50px;
  }

  .decoration-line {
    width: 200px;
    height: 3px;
    background-color: var(--accent);
    position: absolute;
    top: 50px;
    right: -100px;
    transform: rotate(-45deg);
  }

  .lead {
    font-size: 1.125rem;
    color: var(--text-secondary);
    max-width: 800px;
    margin: 0 auto;
    line-height: 1.6;
  }

  .card {
    background-color: var(--bg-secondary);
    border-radius: var(--border-radius);
    box-shadow: var(--box-shadow);
    padding: 1.5rem;
    margin-bottom: 2rem;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    overflow: hidden;
    position: relative;
  }

  .card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
  }

  .card h2 {
    display: flex;
    align-items: center;
    margin-bottom: 1.5rem;
    color: var(--accent);
    border-bottom: 2px solid var(--border-color);
    padding-bottom: 0.75rem;
  }

  .icon {
    margin-right: 0.5rem;
    font-size: 1.25rem;
  }

  .stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 1.5rem;
    margin-top: 1.5rem;
  }

  .stat-card {
    background-color: var(--bg-accent);
    padding: 1.5rem;
    border-radius: var(--border-radius);
    text-align: center;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    position: relative;
    overflow: hidden;
  }

  .stat-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
  }

  .stat-card::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 4px;
    background-color: var(--accent);
    transform: scaleX(0);
    transform-origin: left;
    transition: transform 0.3s ease;
  }

  .stat-card:hover::after {
    transform: scaleX(1);
  }

  .stat-icon {
    font-size: 2rem;
    margin-bottom: 0.5rem;
  }

  .stat-value {
    font-size: 2rem;
    font-weight: 700;
    color: var(--accent);
    margin-bottom: 0.5rem;
  }

  .stat-label {
    font-size: 1.125rem;
    font-weight: 600;
    margin-bottom: 0.5rem;
  }

  .stat-description {
    font-size: 0.875rem;
    color: var(--text-secondary);
  }

  .comparison-table {
    overflow-x: auto;
    margin-top: 1.5rem;
    border-radius: var(--border-radius);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
  }

  table {
    width: 100%;
    border-collapse: collapse;
  }

  th, td {
    padding: 0.75rem 1rem;
    text-align: left;
    border-bottom: 1px solid var(--border-color);
  }

  th {
    background-color: var(--bg-accent);
    font-weight: 600;
    color: var(--accent);
  }

  tr:hover {
    background-color: var(--bg-accent);
  }

  .total-row {
    font-weight: 600;
    background-color: var(--bg-accent);
  }

  .badge {
    display: inline-block;
    padding: 0.25rem 0.5rem;
    border-radius: 9999px;
    font-size: 0.75rem;
    font-weight: 500;
  }

  .badge-success {
    background-color: var(--success);
    color: white;
  }

  .task-icon {
    font-size: 1.25rem;
    margin-right: 0.5rem;
    display: inline-block;
    vertical-align: middle;
  }

  .chart-container {
    margin-top: 1.5rem;
    margin-bottom: 2rem;
    border-radius: var(--border-radius);
    overflow: hidden;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
    background-color: white;
    padding: 1rem;
  }

  .chart-insights {
    background-color: var(--bg-accent);
    padding: 1.5rem;
    border-radius: var(--border-radius);
    margin-top: 1.5rem;
    border-left: 4px solid var(--accent);
  }

  .chart-insights h3 {
    margin-bottom: 1rem;
    color: var(--accent);
  }

  .chart-insights ul {
    padding-left: 1.5rem;
  }

  .chart-insights li {
    margin-bottom: 0.75rem;
    line-height: 1.5;
  }

  .data-insights {
    margin-top: 1.5rem;
  }

  .insight-card {
    display: flex;
    align-items: flex-start;
    background-color: var(--bg-accent);
    padding: 1.5rem;
    border-radius: var(--border-radius);
    border-left: 4px solid var(--accent);
  }

  .insight-icon {
    font-size: 2rem;
    margin-right: 1rem;
    color: var(--accent);
  }

  .insight-content {
    flex: 1;
  }

  .insight-content h3 {
    margin-bottom: 0.5rem;
    color: var(--accent);
  }

  .insight-content p {
    line-height: 1.5;
  }

  .roi-content {
    margin-top: 1rem;
  }

  .roi-intro {
    margin-bottom: 1.5rem;
  }

  .roi-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 1.5rem;
    margin-top: 1.5rem;
    margin-bottom: 1.5rem;
  }

  .roi-item {
    background-color: var(--bg-accent);
    padding: 1.5rem;
    border-radius: var(--border-radius);
    transition: transform 0.3s ease;
    border-top: 4px solid var(--accent);
  }

  .roi-item:hover {
    transform: translateY(-5px);
  }

  .roi-item-header {
    display: flex;
    align-items: center;
    margin-bottom: 1rem;
  }

  .roi-icon {
    font-size: 1.5rem;
    margin-right: 0.75rem;
    color: var(--accent);
  }

  .roi-item h3 {
    margin-bottom: 0;
    font-size: 1.125rem;
    color: var(--accent);
  }

  .roi-item ul {
    padding-left: 1.5rem;
  }

  .roi-item li {
    margin-bottom: 0.5rem;
    line-height: 1.5;
  }

  .roi-summary {
    margin-top: 1.5rem;
  }

  .roi-summary-item {
    display: flex;
    align-items: flex-start;
    background-color: var(--bg-accent);
    padding: 1.25rem;
    border-radius: var(--border-radius);
    margin-bottom: 1rem;
    border-left: 4px solid var(--accent);
  }

  .roi-summary-icon {
    font-size: 1.5rem;
    margin-right: 1rem;
    color: var(--accent);
  }

  .roi-summary-content {
    flex: 1;
  }

  .roi-summary p {
    margin-bottom: 0;
    line-height: 1.5;
  }

  .recommendations-content {
    margin-top: 1rem;
  }

  .recommendation-list {
    padding-left: 0;
    list-style: none;
    counter-reset: recommendation;
  }

  .recommendation-item {
    display: flex;
    align-items: flex-start;
    margin-bottom: 1.5rem;
    background-color: var(--bg-accent);
    padding: 1.25rem;
    border-radius: var(--border-radius);
    transition: transform 0.3s ease;
  }

  .recommendation-item:hover {
    transform: translateY(-3px);
  }

  .recommendation-number {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 2.5rem;
    height: 2.5rem;
    background-color: var(--accent);
    color: white;
    border-radius: 50%;
    font-size: 1.25rem;
    font-weight: 600;
    margin-right: 1rem;
    flex-shrink: 0;
  }

  .recommendation-content {
    flex: 1;
    line-height: 1.5;
  }

  .recommendation-content strong {
    color: var(--accent);
    display: block;
    margin-bottom: 0.5rem;
    font-size: 1.1rem;
  }

  .navigation-links {
    margin-top: 3rem;
    margin-bottom: 2rem;
  }

  .nav-buttons {
    display: flex;
    justify-content: center;
    gap: 1rem;
  }

  .btn {
    display: inline-block;
    padding: 0.75rem 1.5rem;
    border-radius: var(--border-radius);
    font-weight: 600;
    text-align: center;
    text-decoration: none;
    cursor: pointer;
    transition: all 0.3s ease;
  }

  .btn-primary {
    background-color: var(--accent);
    color: white;
    border: 2px solid var(--accent);
  }

  .btn-primary:hover {
    background-color: transparent;
    color: var(--accent);
  }

  .btn-secondary {
    background-color: transparent;
    color: var(--accent);
    border: 2px solid var(--accent);
  }

  .btn-secondary:hover {
    background-color: var(--accent);
    color: white;
  }

  @media (max-width: 768px) {
    .nav-buttons {
      flex-direction: column;
      align-items: center;
    }
    
    .stat-value {
      font-size: 1.75rem;
    }
    
    table {
      font-size: 0.875rem;
    }
    
    th, td {
      padding: 0.5rem;
    }
    
    .roi-grid {
      grid-template-columns: 1fr;
    }

    .recommendation-item {
      flex-direction: column;
    }

    .recommendation-number {
      margin-bottom: 1rem;
    }
  }
</style>
